{"remainingRequest":"C:\\Users\\timoo\\Desktop\\ShadeHost\\Entwicklung\\NodeJS-Frontend\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\timoo\\Desktop\\ShadeHost\\Entwicklung\\NodeJS-Frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\timoo\\Desktop\\ShadeHost\\Entwicklung\\NodeJS-Frontend\\src\\routes\\router.js","dependencies":[{"path":"C:\\Users\\timoo\\Desktop\\ShadeHost\\Entwicklung\\NodeJS-Frontend\\src\\routes\\router.js","mtime":1633361344270},{"path":"C:\\Users\\timoo\\Desktop\\ShadeHost\\Entwicklung\\NodeJS-Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1632338999961},{"path":"C:\\Users\\timoo\\Desktop\\ShadeHost\\Entwicklung\\NodeJS-Frontend\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1632339000298},{"path":"C:\\Users\\timoo\\Desktop\\ShadeHost\\Entwicklung\\NodeJS-Frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1632338992451}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXM3LmFycmF5LmluY2x1ZGVzIjsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgQXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgVnVlUm91dGVyIGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgcm91dGVzIGZyb20gIi4vcm91dGVzIjsKaW1wb3J0IEF1dGhTZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL0F1dGhTZXJ2aWNlIjsKaW1wb3J0IHN0b3JlIGZyb20gIi4uL3N0b3JlIjsKVnVlLnVzZShWdWVSb3V0ZXIpOyAvLyBjb25maWd1cmUgcm91dGVyCgp2YXIgcm91dGVyID0gbmV3IFZ1ZVJvdXRlcih7CiAgbW9kZTogJ2hpc3RvcnknLAogIHJvdXRlczogcm91dGVzLAogIC8vIHNob3J0IGZvciByb3V0ZXM6IHJvdXRlcwogIGxpbmtBY3RpdmVDbGFzczogJ2FjdGl2ZScsCiAgc2Nyb2xsQmVoYXZpb3I6IGZ1bmN0aW9uIHNjcm9sbEJlaGF2aW9yKHRvLCBmcm9tLCBzYXZlZFBvc2l0aW9uKSB7CiAgICBpZiAoc2F2ZWRQb3NpdGlvbikgewogICAgICByZXR1cm4gc2F2ZWRQb3NpdGlvbjsKICAgIH0KCiAgICBpZiAodG8uaGFzaCkgewogICAgICByZXR1cm4gewogICAgICAgIHNlbGVjdG9yOiB0by5oYXNoCiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgeDogMCwKICAgICAgeTogMAogICAgfTsKICB9Cn0pOwpyb3V0ZXIuYmVmb3JlRWFjaChmdW5jdGlvbiAodG8sIGZyb20sIG5leHQpIHsKICAvLyByZWRpcmVjdCB0byBsb2dpbiBwYWdlIGlmIG5vdCBsb2dnZWQgaW4gYW5kIHRyeWluZyB0byBhY2Nlc3MgYSByZXN0cmljdGVkIHBhZ2UKICB2YXIgYXV0aFBhZ2VzID0gWycvbG9naW4nLCAnL3JlZ2lzdGVyJ107CiAgdmFyIGlzUHVibGljUGFnZSA9IGF1dGhQYWdlcy5pbmNsdWRlcyh0by5wYXRoKTsKICB2YXIgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKTsKCiAgaWYgKHRvLnBhdGggPT0gIi9hZ2IiIHx8IHRvLnBhdGggPT0gIi9pbXByZXNzdW0iIHx8IHRvLnBhdGggPT0gIi9kYXRlbnNjaHV0eiIgfHwgdG8ucGF0aCA9PSAiL3dpZWRlcnJ1ZiIpIHsKICAgIHJldHVybiBuZXh0KCk7CiAgfQoKICBpZiAodG9rZW4pIHsKICAgIEF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydBdXRob3JpemF0aW9uJ10gPSAiQmVhcmVyICIuY29uY2F0KHRva2VuKTsKICAgIEF1dGhTZXJ2aWNlLmdldFByb2ZpbGUoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7CiAgICAgIHN0b3JlLmRpc3BhdGNoKCJhdXRoL3VzZXIiLCB1c2VyKTsKCiAgICAgIGlmIChpc1B1YmxpY1BhZ2UpIHsKICAgICAgICByZXR1cm4gbmV4dCgnLycpOwogICAgICB9CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgaWYgKCFpc1B1YmxpY1BhZ2UpIHsKICAgICAgICByZXR1cm4gbmV4dCgnL2xvZ2luJyk7CiAgICAgIH0KICAgIH0pOwogIH0gZWxzZSB7CiAgICBpZiAoIWlzUHVibGljUGFnZSkgewogICAgICByZXR1cm4gbmV4dCgnL2xvZ2luJyk7CiAgICB9CiAgfQoKICBuZXh0KCk7Cn0pOwpleHBvcnQgZGVmYXVsdCByb3V0ZXI7"},{"version":3,"sources":["C:/Users/timoo/Desktop/ShadeHost/Entwicklung/NodeJS-Frontend/src/routes/router.js"],"names":["Vue","Axios","VueRouter","routes","AuthService","store","use","router","mode","linkActiveClass","scrollBehavior","to","from","savedPosition","hash","selector","x","y","beforeEach","next","authPages","isPublicPage","includes","path","token","localStorage","getItem","defaults","headers","common","getProfile","then","user","dispatch","catch","error"],"mappings":";AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,MAAP;AACA,OAAOC,WAAP;AACA,OAAOC,KAAP;AAEAL,GAAG,CAACM,GAAJ,CAAQJ,SAAR,E,CAEA;;AACA,IAAMK,MAAM,GAAG,IAAIL,SAAJ,CAAc;AAC3BM,EAAAA,IAAI,EAAE,SADqB;AAE3BL,EAAAA,MAAM,EAANA,MAF2B;AAEnB;AACRM,EAAAA,eAAe,EAAE,QAHU;AAI3BC,EAAAA,cAAc,EAAE,wBAACC,EAAD,EAAKC,IAAL,EAAWC,aAAX,EAA6B;AAC3C,QAAIA,aAAJ,EAAmB;AACjB,aAAOA,aAAP;AACD;;AACD,QAAIF,EAAE,CAACG,IAAP,EAAa;AACX,aAAO;AAAEC,QAAAA,QAAQ,EAAEJ,EAAE,CAACG;AAAf,OAAP;AACD;;AACD,WAAO;AAAEE,MAAAA,CAAC,EAAE,CAAL;AAAQC,MAAAA,CAAC,EAAE;AAAX,KAAP;AACD;AAZ0B,CAAd,CAAf;AAeAV,MAAM,CAACW,UAAP,CAAkB,UAACP,EAAD,EAAKC,IAAL,EAAWO,IAAX,EAAoB;AACpC;AAEA,MAAMC,SAAS,GAAG,CAAC,QAAD,EAAW,WAAX,CAAlB;AACA,MAAMC,YAAY,GAAGD,SAAS,CAACE,QAAV,CAAmBX,EAAE,CAACY,IAAtB,CAArB;AACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;;AAEA,MAAGf,EAAE,CAACY,IAAH,IAAW,MAAX,IAAqBZ,EAAE,CAACY,IAAH,IAAW,YAAhC,IAAgDZ,EAAE,CAACY,IAAH,IAAW,cAA3D,IAA6EZ,EAAE,CAACY,IAAH,IAAW,YAA3F,EAAyG;AACvG,WAAOJ,IAAI,EAAX;AACD;;AAED,MAAGK,KAAH,EAAU;AACRvB,IAAAA,KAAK,CAAC0B,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,qBAA2DL,KAA3D;AACApB,IAAAA,WAAW,CAAC0B,UAAZ,GAAyBC,IAAzB,CAA8B,UAAAC,IAAI,EAAI;AACpC3B,MAAAA,KAAK,CAAC4B,QAAN,CAAe,WAAf,EAA4BD,IAA5B;;AACA,UAAGX,YAAH,EAAiB;AACf,eAAOF,IAAI,CAAC,GAAD,CAAX;AACD;AACF,KALD,EAKGe,KALH,CAKS,UAAAC,KAAK,EAAI;AAChB,UAAG,CAACd,YAAJ,EAAkB;AAChB,eAAOF,IAAI,CAAC,QAAD,CAAX;AACD;AACF,KATD;AAUD,GAZD,MAYO;AACL,QAAG,CAACE,YAAJ,EAAkB;AAChB,aAAOF,IAAI,CAAC,QAAD,CAAX;AACD;AACF;;AAEDA,EAAAA,IAAI;AACL,CA9BD;AAgCA,eAAeZ,MAAf","sourcesContent":["import Vue from 'vue';\r\nimport Axios from 'axios';\r\nimport VueRouter from 'vue-router';\r\nimport routes from './routes';\r\nimport AuthService from '../services/AuthService'\r\nimport store from '../store'\r\n\r\nVue.use(VueRouter);\r\n\r\n// configure router\r\nconst router = new VueRouter({\r\n  mode: 'history',\r\n  routes, // short for routes: routes\r\n  linkActiveClass: 'active',\r\n  scrollBehavior: (to, from ,savedPosition) => {\r\n    if (savedPosition) {\r\n      return savedPosition;\r\n    }\r\n    if (to.hash) {\r\n      return { selector: to.hash };\r\n    }\r\n    return { x: 0, y: 0 };\r\n  }\r\n});\r\n\r\nrouter.beforeEach((to, from, next) => {\r\n  // redirect to login page if not logged in and trying to access a restricted page\r\n\r\n  const authPages = ['/login', '/register'];\r\n  const isPublicPage = authPages.includes(to.path);\r\n  const token = localStorage.getItem('token');\r\n\r\n  if(to.path == \"/agb\" || to.path == \"/impressum\" || to.path == \"/datenschutz\" || to.path == \"/wiederruf\") {\r\n    return next();\r\n  }\r\n\r\n  if(token) {\r\n    Axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n    AuthService.getProfile().then(user => {\r\n      store.dispatch(\"auth/user\", user);\r\n      if(isPublicPage) {\r\n        return next('/');\r\n      }\r\n    }).catch(error => {\r\n      if(!isPublicPage) {\r\n        return next('/login');\r\n      }\r\n    });\r\n  } else {\r\n    if(!isPublicPage) {\r\n      return next('/login');\r\n    }\r\n  }\r\n\r\n  next();\r\n})\r\n\r\nexport default router;\r\n"]}]}